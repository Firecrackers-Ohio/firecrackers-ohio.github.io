---
const { pathname } = Astro.url;
const pageTitles: Record<string, string> = {
  "": "Home",
  about: "About",
  teams: "Teams",
};

// Handle team-specific pages and tryouts
let pageTitle = pageTitles[pathname.slice(1)] || "Home";
if (pathname.startsWith("/teams/")) {
  const teamName = pathname.split("/")[2];
  if (teamName === "brown") {
    pageTitle = "10U Brown";
  } else if (teamName === "nieman") {
    pageTitle = "11U Nieman";
  } else if (teamName === "allen") {
    pageTitle = "12U Allen";
  } else if (teamName === "jones") {
    pageTitle = "13U Jones";
  } else if (teamName === "evans") {
    pageTitle = "14U Evans";
  }
} else if (pathname.slice(1) === "tryouts") {
  pageTitle = "Tryouts";
}
---

<nav class="top-0 z-50 bg-black">
  <div class="flex flex-row h-16">
    <div class="w-24 h-24 md:w-32 md:h-32 p-2 flex-none -mt-1 relative">
      <a href="/">
        <img src="/logo-round.svg" alt="Firecrackers of Central Ohio Logo" />
      </a>
    </div>
    <div class="w-screen flex flex-row p-2 flex-auto">
      <!-- Mobile Page Title -->
      <div class="md:hidden flex items-center justify-center flex-1">
        <h1 class="text-white font-bold text-lg">{pageTitle}</h1>
      </div>

      <!-- Desktop Menu -->
      <div class="hidden md:flex flex-row space-x-6 items-center">
        <div class="menu-item">
          <a class={pathname.slice(1) === "" ? "active" : ""} href="/">Home</a>
        </div>
        <div class="menu-item">
          <a class={pathname.slice(1) === "about" ? "active" : ""} href="/about"
            >About</a
          >
        </div>
        <div class="menu-item relative">
          <button
            id="teams-dropdown-button"
            class={pathname.slice(1) === "teams" ||
            pathname.startsWith("/teams/")
              ? "active"
              : ""}
          >
            Teams
            <svg
              class="w-4 h-4 ml-1 inline"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div
            id="teams-dropdown"
            class="hidden absolute top-full left-0 mt-1 w-48 bg-black border border-gray-700 rounded shadow-lg z-50"
          >
            <a
              href="/tryouts"
              class="block px-4 py-2 text-white hover:bg-gray-800">Tryouts</a
            >
            <a
              href="/teams"
              class="block px-4 py-2 text-white hover:bg-gray-800">All Teams</a
            >
            <a
              href="/teams/brown"
              class="block px-4 py-2 text-white hover:bg-gray-800">10U Brown</a
            >
            <a
              href="/teams/nieman"
              class="block px-4 py-2 text-white hover:bg-gray-800">11U Nieman</a
            >
            <a
              href="/teams/allen"
              class="block px-4 py-2 text-white hover:bg-gray-800">12U Allen</a
            >
            <a
              href="/teams/jones"
              class="block px-4 py-2 text-white hover:bg-gray-800">13U Jones</a
            >
            <a
              href="/teams/evans"
              class="block px-4 py-2 text-white hover:bg-gray-800">14U Evans</a
            >
          </div>
        </div>
        <div class="menu-item">
          <a href="https://gear.firecrackersoftball.com/" target="_blank"
            >Store</a
          >
        </div>
      </div>
    </div>
    <div
      class="w-10 h-full bg-[linear-gradient(120deg,_#000000_50%,_#c20202_50%)] flex-none"
    >
    </div>
    <div class="bg-[#c20202] text-white flex flex-row p-2">
      <!-- Mobile Menu Button -->
      <div class="md:hidden flex items-center">
        <button id="mobile-menu-button" class="text-white p-2">
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>

      <!-- Desktop Social Icons -->
      <div class="hidden md:flex flex-row">
        <div class="social-icon">
          <a href="https://www.facebook.com/firecrackersohio" target="_blank">
            <img src="/fb.svg" alt="Facebook" class="h-10" />
          </a>
        </div>
        <div class="social-icon">
          <a
            href="https://www.instagram.com/firecrackers_jones_2012/"
            target="_blank"
          >
            <img src="/ig.svg" alt="Instagram" class="h-10" />
          </a>
        </div>
        <div class="social-icon">
          <a href="#" target="_blank">
            <img src="/email.svg" alt="Email" class="h-10" />
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden md:hidden bg-black relative z-50">
    <div class="px-4 py-2 pb-6 space-y-2">
      <div class="menu-item">
        <a class={pathname.slice(1) === "" ? "active" : ""} href="/">Home</a>
      </div>
      <div class="menu-item">
        <a class={pathname.slice(1) === "about" ? "active" : ""} href="/about"
          >About</a
        >
      </div>
      <div class="menu-item">
        <button
          id="mobile-teams-dropdown-button"
          class={pathname.slice(1) === "teams" || pathname.startsWith("/teams/")
            ? "active"
            : ""}
        >
          Teams
          <svg
            class="w-4 h-4 ml-1 inline mobile-teams-chevron transition-transform"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"></path>
          </svg>
        </button>
      </div>
      <div
        id="mobile-teams-dropdown"
        class="hidden overflow-hidden transition-all duration-300 ease-in-out"
      >
        <div
          class="ml-4 mt-2 space-y-2 bg-gray-900 rounded p-3 border border-gray-700 shadow-lg"
        >
          <a href="/tryouts" class="block text-white hover:text-red-400 py-1"
            >Tryouts</a
          >
          <a href="/teams" class="block text-white hover:text-red-400 py-1"
            >All Teams</a
          >
          <a
            href="/teams/brown"
            class="block text-white hover:text-red-400 py-1">10U Brown</a
          >
          <a
            href="/teams/nieman"
            class="block text-white hover:text-red-400 py-1">11U Nieman</a
          >
          <a
            href="/teams/allen"
            class="block text-white hover:text-red-400 py-1">12U Allen</a
          >
          <a
            href="/teams/jones"
            class="block text-white hover:text-red-400 py-1">13U Jones</a
          >
          <a
            href="/teams/evans"
            class="block text-white hover:text-red-400 py-1">14U Evans</a
          >
        </div>
      </div>
      <div class="menu-item">
        <a href="https://gear.firecrackersoftball.com/" target="_blank">Store</a
        >
      </div>

      <!-- Mobile Social Icons -->
      <div class="border-t border-gray-700 pt-4 mt-5">
        <div class="flex justify-center space-x-4">
          <div class="social-icon">
            <a href="https://www.facebook.com/firecrackersohio" target="_blank">
              <img src="/fb.svg" alt="Facebook" class="h-8" />
            </a>
          </div>
          <div class="social-icon">
            <a
              href="https://www.instagram.com/firecrackers_jones_2012/"
              target="_blank"
            >
              <img src="/ig.svg" alt="Instagram" class="h-8" />
            </a>
          </div>
          <div class="social-icon">
            <a href="#" target="_blank">
              <img src="/email.svg" alt="Email" class="h-8" />
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const mobileMenuButton = document.getElementById("mobile-menu-button");
    const mobileMenu = document.getElementById("mobile-menu");

    if (mobileMenuButton && mobileMenu) {
      mobileMenuButton.addEventListener("click", function () {
        mobileMenu.classList.toggle("hidden");
      });
    }

    // Desktop Teams Dropdown
    const teamsDropdownButton = document.getElementById(
      "teams-dropdown-button",
    );
    const teamsDropdown = document.getElementById("teams-dropdown");

    if (teamsDropdownButton && teamsDropdown) {
      teamsDropdownButton.addEventListener("click", function () {
        teamsDropdown.classList.toggle("hidden");
      });

      // Close dropdown when clicking outside
      document.addEventListener("click", function (event) {
        if (
          !teamsDropdownButton.contains(event.target as Node) &&
          !teamsDropdown.contains(event.target as Node)
        ) {
          teamsDropdown.classList.add("hidden");
        }
      });
    }

    // Mobile Teams Dropdown
    const mobileTeamsDropdownButton = document.getElementById(
      "mobile-teams-dropdown-button",
    );
    const mobileTeamsDropdown = document.getElementById(
      "mobile-teams-dropdown",
    );
    const mobileTeamsChevron = document.querySelector(".mobile-teams-chevron");

    if (
      mobileTeamsDropdownButton &&
      mobileTeamsDropdown &&
      mobileTeamsChevron
    ) {
      mobileTeamsDropdownButton.addEventListener("click", function () {
        const isHidden = mobileTeamsDropdown.classList.contains("hidden");

        if (isHidden) {
          mobileTeamsDropdown.classList.remove("hidden");
          mobileTeamsChevron.classList.add("rotate-180");
        } else {
          mobileTeamsDropdown.classList.add("hidden");
          mobileTeamsChevron.classList.remove("rotate-180");
        }
      });
    }
  });
</script>
